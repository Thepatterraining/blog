---
title: 设计模式之享元模式--共享内存来节省空间
date: 2020-05-06 09:34:43
tags: ['设计原则','设计模式']
category: 设计模式
article: 设计模式之享元模式--共享内存来节省空间
---

# 设计模式之享元模式--共享内存来节省空间

`享元模式`是说共享单元，如果有一样的部分那么共享一个组件而不是复制，也就是传址不传值。

> 运用共享技术有效地支持大量细粒度的对象。

## 为什么要使用享元模式

享元模式体现在很多地方，比如后端共享一套代码给前端各个平台，很多接口都是同一个。

享元模式是复用性的体现，大量节省了空间。

比如棋牌游戏，棋子和牌都是一样的，那么他们就可以复用同一个。

#### 五子棋游戏

五子棋只有`黑子`和`白子`，虽然我们用到了很多，但是他们其实指向了同一个内存空间，只不过创建了很多对象而已。

#### 象棋游戏

象棋也只有`车马炮`这些棋子，同样可以复用，不然如果你每个棋局重新创建，那么内存很容易溢出。

#### 扑克牌游戏

扑克牌也只有`123`到大王这些固定的牌。

#### 递归算法

很多递归算法也可以通过享元模式来优化，递归到最后其实有很多是重复的值，而如果每个重复的值都需要重新占用空间，那么造成了大量的空间浪费，这也是递归慢和容易内存溢出的原因之一。

享元模式其实很简单，就是有需要的时候把已经存在的东西拿出来复用。

比如可以通过数组存储，然后需要的时候直接复用就好了。

比如通过`简单工厂`来创建对象的时候，如果有很多请求过来访问这个工厂，那么工厂需要创建很多对象返回。

而如果通过数组存起来，那么只返回一个对象，就节省了空间。

当然了，享元模式共享的只能是`可读对象`，一定是不可修改的。

如果可以修改就会造成某个地方修改而其他地方不可用的bug。

