---
title: 评论来啦 -- 关于 hexo next 集成 gitment
date: 2018-03-16
tags: [hexo, blog, gitment]
category: hexo
article: "评论来啦"
---

# 全新的gitment 评论上线啦！

小伙伴们可以评论啦，开不开心，惊不惊喜，本来看网上说用 多说 的，结果发现 多说 没了？ 没了？ 没了？ excuse me?
然后，苦逼的我只能继续找，就发现了这个 gitment ，感觉不错，来用一用，瞬间高大上啊，这个 next 主题 好像已经集成好 gitment 了，
我们只用简单设置一下就能用了，舒服。

### 注册OAuth Application

    https://github.com/settings/applications/new

上面的连接，点击注册，会让你输入4个东西

    Application name
    Homepage URL
    Application description
    Authorization callback URL

最后 这个东西 要填你 博客的 url ，点进去之后 都会有说明。弄完之后 会出现两个东西

    Client ID
    Client Secret

这两个东西 大家 要记住了。接下来配置的时候会用到。

### 配置 next

打开我们的站点配置文件 _config.yml 然后找到 gitment。

    enable: true
    mint: true # RECOMMEND, A mint on Gitment, to support count, language and proxy_gateway
    count: true # Show comments count in post meta area
    lazy: false # Comments lazy loading with a button
    cleanly: false # Hide 'Powered by ...' on footer, and more
    language: 语言
    github_user: 你的 github 名
    github_repo: 你的仓库名
    client_id: 刚刚的 Client ID
    client_secret: 刚刚的 Client Secret

配置完之后 就可以 看一下效果了。

## 后记

来看一下 这玩意有哪些坑吧
在配置的时候 blog/themes/next/layout/_third-party/comments/gitment.swig 这个文件的时候，下面这些取得都是配置里面设置的，一定要一一对应哦

    {% set owner = theme.gitment.github_user %}
    {% set repo = theme.gitment.github_repo %}
    {% set cid = theme.gitment.client_id %}
    {% set cs = theme.gitment.client_secret %}

错误

    error:not found

这个错误的话，你就要仔细检查上面的参数啦，一定是owner 和 repo 这两个参数有问题，和你github上面的用户名和仓库名 不一样导致的

## 初始化

关于初始化，这个评论是需要初始化的，嗯，每个文章你都要去初始化，很麻烦。对于我这种没几个文章的来说，还行。
在 gitment.swig 这个文件里面 有这样一处代码
```js
    var gitment = new Gitment({
        id: '{{page.article}}',
        owner: '{{owner}}',
        repo: '{{repo}}',
        oauth: {
            client_id: '{{cid}}',
            client_secret: '{{cs}}',
        }
    });
```

这个里面 有个 id 的设置 他默认的是 `location.href`，这个时候大家注意了，因为这个东西 本质是创建一个 issue,然后他创建的时候，会有一个 label 传过去，来区分你每个文章的评论，他传的是什么呢，是一个数组, 最最重要的是，这tm有长度限制，你用 href 的话，基本是超出的，反正我是，然后我试了一下 pathname ，依然超出。

网上有人用的是时间，也有标题，我就不一样了，我给每个文章加了个 article 来区分他们。使用方法就是上面那样。我也用过时间，然后他告诉我 不是 string or object ，晕，标题，万一没控制好超长了就不好玩了。大家根据需求来就行了，有问题的欢迎评论。

    [
        gitment,
        你写的id
    ]
